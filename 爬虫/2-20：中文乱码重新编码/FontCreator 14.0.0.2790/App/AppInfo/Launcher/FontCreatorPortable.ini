[Launch]
ProgramExecutable=FontCreator\FontCreator.exe
SinglePortableAppInstance=true
DirectoryMoveOK=yes

[Activate]    
Registry=true

[RegistryKeys]
AppID {00FC221C-108B-4A53-884F-3AC1B036FA65}=HKLM\SOFTWARE\Classes\AppID\{00FC221C-108B-4A53-884F-3AC1B036FA65}
CLSID {00FC221C-108B-4A53-884F-3AC1B036FA65}=HKLM\SOFTWARE\Classes\CLSID\{00FC221C-108B-4A53-884F-3AC1B036FA65}
fcp=HKLM\SOFTWARE\Classes\.fcp
FontCreator=HKLM\SOFTWARE\High-Logic\FontCreator
FontInstaller2.dll=HKLM\SOFTWARE\Classes\AppID\FontInstaller2.dll
FontInstaller2.MyFontInstallerObject=HKLM\SOFTWARE\Classes\FontInstaller2.MyFontInstallerObject
HighLogic.FontCreator.Font=HKLM\SOFTWARE\Classes\HighLogic.FontCreator.Font
HighLogic.FontCreator.Project=HKLM\SOFTWARE\Classes\HighLogic.FontCreator.Project
HKCU FontCreator=HKCU\Software\High-Logic\FontCreator
Interface {00FB9B33-BA33-498E-AE8A-6AAE0BF22865}=HKLM\SOFTWARE\Classes\Interface\{00FB9B33-BA33-498E-AE8A-6AAE0BF22865}
otf OpenWithProgids=HKLM\SOFTWARE\Classes\.otf\OpenWithProgids
ttc OpenWithProgids=HKLM\SOFTWARE\Classes\.ttc\OpenWithProgids
ttf OpenWithProgids=HKLM\SOFTWARE\Classes\.ttf\OpenWithProgids
TypeLib {00FA5C55-FD1B-404C-BF09-2191508D2A65}=HKLM\SOFTWARE\Classes\TypeLib\{00FA5C55-FD1B-404C-BF09-2191508D2A65}
woff=HKLM\SOFTWARE\Classes\.woff
woff2=HKLM\SOFTWARE\Classes\.woff2

[RegistryValueWrite]
HKLM\SOFTWARE\Classes\AppID\{00FC221C-108B-4A53-884F-3AC1B036FA65}\=REG_SZ:MyFontInstallerObject
HKLM\SOFTWARE\Classes\AppID\{00FC221C-108B-4A53-884F-3AC1B036FA65}\DllSurrogate=REG_SZ:
HKLM\SOFTWARE\Classes\AppID\{00FC221C-108B-4A53-884F-3AC1B036FA65}\AccessPermission=REG_BINARY:01000480440000005400000000000000140000000200300002000000000014000300000001010000000000050400000000001400030000000101000000000005120000000102000000000005200000002002000001020000000000052000000020020000
HKLM\SOFTWARE\Classes\CLSID\{00FC221C-108B-4A53-884F-3AC1B036FA65}\=REG_SZ:MyFontInstallerObject
HKLM\SOFTWARE\Classes\CLSID\{00FC221C-108B-4A53-884F-3AC1B036FA65}\AppID=REG_SZ:{00FC221C-108B-4A53-884F-3AC1B036FA65}
HKLM\SOFTWARE\Classes\CLSID\{00FC221C-108B-4A53-884F-3AC1B036FA65}\LocalizedString=REG_SZ:@%PAL:AppDir%\Windows\system32\FontInstaller2.dll,-101
HKLM\SOFTWARE\Classes\CLSID\{00FC221C-108B-4A53-884F-3AC1B036FA65}\Elevation\Enabled=REG_DWORD:1
HKLM\SOFTWARE\Classes\CLSID\{00FC221C-108B-4A53-884F-3AC1B036FA65}\InprocServer32\=REG_SZ:%PAL:AppDir%\Windows\system32\FontInstaller2.dll
HKLM\SOFTWARE\Classes\CLSID\{00FC221C-108B-4A53-884F-3AC1B036FA65}\InprocServer32\ThreadingModel=REG_SZ:Apartment
HKLM\SOFTWARE\Classes\CLSID\{00FC221C-108B-4A53-884F-3AC1B036FA65}\ProgID\=REG_SZ:FontInstaller2.MyFontInstallerObject
HKLM\SOFTWARE\Classes\CLSID\{00FC221C-108B-4A53-884F-3AC1B036FA65}\TypeLib\=REG_SZ:{00FA5C55-FD1B-404C-BF09-2191508D2A65}
HKLM\SOFTWARE\Classes\CLSID\{00FC221C-108B-4A53-884F-3AC1B036FA65}\Version\=REG_SZ:2.2
HKLM\SOFTWARE\Classes\.fcp\=REG_SZ:HighLogic.FontCreator.Project
HKLM\SOFTWARE\Classes\.fcp\OpenWithProgids\HighLogic.FontCreator.Project=REG_SZ:
HKLM\SOFTWARE\High-Logic\FontCreator\Path=REG_SZ:%PAL:AppDir%\FontCreator
HKLM\SOFTWARE\High-Logic\FontCreator\Version=REG_SZ:14.0
HKLM\SOFTWARE\High-Logic\FontCreator\14.0\
HKLM\SOFTWARE\High-Logic\FontCreator\14.0\Capabilities\ApplicationIcon=REG_SZ:%PAL:AppDir%\FontCreator\FontCreator.exe,0
HKLM\SOFTWARE\High-Logic\FontCreator\14.0\Capabilities\ApplicationName=REG_SZ:FontCreator
HKLM\SOFTWARE\High-Logic\FontCreator\14.0\Capabilities\FileAssociations\.fcp=REG_SZ:HighLogic.FontCreator.Project
HKLM\SOFTWARE\High-Logic\FontCreator\14.0\Capabilities\FileAssociations\.ttf=REG_SZ:HighLogic.FontCreator.Font
HKLM\SOFTWARE\High-Logic\FontCreator\14.0\Capabilities\FileAssociations\.otf=REG_SZ:HighLogic.FontCreator.Font
HKLM\SOFTWARE\High-Logic\FontCreator\14.0\Capabilities\FileAssociations\.ttc=REG_SZ:HighLogic.FontCreator.Font
HKLM\SOFTWARE\High-Logic\FontCreator\14.0\Capabilities\FileAssociations\.woff=REG_SZ:HighLogic.FontCreator.Font
HKLM\SOFTWARE\High-Logic\FontCreator\14.0\Capabilities\FileAssociations\.woff2=REG_SZ:HighLogic.FontCreator.Font
HKLM\SOFTWARE\Classes\AppID\FontInstaller2.dll\AppID=REG_SZ:{00FC221C-108B-4A53-884F-3AC1B036FA65}
HKLM\SOFTWARE\Classes\FontInstaller2.MyFontInstallerObject\=REG_SZ:MyFontInstallerObject
HKLM\SOFTWARE\Classes\FontInstaller2.MyFontInstallerObject\Clsid\=REG_SZ:{00FC221C-108B-4A53-884F-3AC1B036FA65}
HKLM\SOFTWARE\Classes\HighLogic.FontCreator.Font\=REG_SZ:FontCreator Font
HKLM\SOFTWARE\Classes\HighLogic.FontCreator.Font\AppUserModelID=REG_SZ:High-Logic.FontCreator.12
HKLM\SOFTWARE\Classes\HighLogic.FontCreator.Font\DefaultIcon\=REG_SZ:%PAL:AppDir%\FontCreator\FontCreator.exe,0
HKLM\SOFTWARE\Classes\HighLogic.FontCreator.Font\shell\
HKLM\SOFTWARE\Classes\HighLogic.FontCreator.Font\shell\open\
HKLM\SOFTWARE\Classes\HighLogic.FontCreator.Font\shell\open\command\=REG_SZ:"%PAL:AppDir%\FontCreator\FontCreator.exe" "%1"
HKLM\SOFTWARE\Classes\HighLogic.FontCreator.Project\=REG_SZ:FontCreator Project
HKLM\SOFTWARE\Classes\HighLogic.FontCreator.Project\AppUserModelID=REG_SZ:High-Logic.FontCreator.12
HKLM\SOFTWARE\Classes\HighLogic.FontCreator.Project\DefaultIcon\=REG_SZ:%PAL:AppDir%\FontCreator\FontCreator.exe,0
HKLM\SOFTWARE\Classes\HighLogic.FontCreator.Project\shell\
HKLM\SOFTWARE\Classes\HighLogic.FontCreator.Project\shell\open\
HKLM\SOFTWARE\Classes\HighLogic.FontCreator.Project\shell\open\command\=REG_SZ:"%PAL:AppDir%\FontCreator\FontCreator.exe" "%1"
HKCU\Software\High-Logic\FontCreator\14.0\Reg\V5D1=REG_SZ:RYW4ADUBFD1
HKCU\Software\High-Logic\FontCreator\14.0\Reg\V5D2=REG_SZ:E5D8A50B23FA6FA1FF2D82F2C18B88DA
HKCU\Software\High-Logic\FontCreator\14.0\Reg\V5D3=REG_SZ:076222B4385A7392317F8433FB7F2288
HKCU\Software\High-Logic\FontCreator\14.0\Reg\V5D4=REG_SZ:9184609B3EC538103CECA740DD7241A9B8303A1C2BE59D5582B11728DA8FB43215855B7960D082FE03B6BC4C6CFAFE7D4FB8F7BB7D2D3A2176ED4E03D339499FE0235AEC670F11E4FAE52ABD2FF0999CC5C123715FB91CB45EC392D510443B1EDBACB41F2227E4D11CC8724C5A10B71FE52E4B05588C903A83C9E07C217139BC791963D36FA0ED04CB405EC18CA76F05AE05995F0F358FD361308982F37B8FA7BA927821BEC2E879F04C3F105A780C67BC75416B1E721719D9FA6B92B2D05F765DF141B413DBCE0DBD8D5123621034012F994DB6E905B7AD3CB117483ACE130D73ACE00D4F7246BC8D260CB86B72812A1A089ED4DE01795151CA9DDF30098EC1BF0865372BA48817C9622A3626607E36F0687F3EBC364002F3E6AC0721ADB3D58DDD10DDF399FB75E29793036B33137AD17DF87CCB3622F1DC9925C9CB4D2648CD07003923101F371D61297E3E0F5B1DD6FC88D4FAD1FBA40E8509183CE8127D
HKCU\Software\High-Logic\FontCreator\14.0\Reg\V5D5=REG_SZ:
HKCU\Software\High-Logic\FontCreator\14.0\GUI\UpdateCheckInterval=REG_DWORD:0
HKLM\SOFTWARE\Classes\Interface\{00FB9B33-BA33-498E-AE8A-6AAE0BF22865}\=REG_SZ:IMyFontInstallerObject
HKLM\SOFTWARE\Classes\Interface\{00FB9B33-BA33-498E-AE8A-6AAE0BF22865}\ProxyStubClsid32\=REG_SZ:{00020424-0000-0000-C000-000000000046}
HKLM\SOFTWARE\Classes\Interface\{00FB9B33-BA33-498E-AE8A-6AAE0BF22865}\TypeLib\=REG_SZ:{00FA5C55-FD1B-404C-BF09-2191508D2A65}
HKLM\SOFTWARE\Classes\Interface\{00FB9B33-BA33-498E-AE8A-6AAE0BF22865}\TypeLib\Version=REG_SZ:2.2
HKLM\SOFTWARE\Classes\.otf\OpenWithProgids\HighLogic.FontCreator.Font=REG_SZ:
HKLM\SOFTWARE\Classes\.ttc\OpenWithProgids\HighLogic.FontCreator.Font=REG_SZ:
HKLM\SOFTWARE\Classes\.ttf\OpenWithProgids\HighLogic.FontCreator.Font=REG_SZ:
HKLM\SOFTWARE\Classes\TypeLib\{00FA5C55-FD1B-404C-BF09-2191508D2A65}\2.2\=REG_SZ:FontInstaller2 Library
HKLM\SOFTWARE\Classes\TypeLib\{00FA5C55-FD1B-404C-BF09-2191508D2A65}\2.2\0\
HKLM\SOFTWARE\Classes\TypeLib\{00FA5C55-FD1B-404C-BF09-2191508D2A65}\2.2\0\win32\=REG_SZ:%PAL:AppDir%\Windows\System32\FontInstaller2.dll
HKLM\SOFTWARE\Classes\TypeLib\{00FA5C55-FD1B-404C-BF09-2191508D2A65}\2.2\FLAGS\=REG_SZ:0
HKLM\SOFTWARE\Classes\TypeLib\{00FA5C55-FD1B-404C-BF09-2191508D2A65}\2.2\HELPDIR\=REG_SZ:%PAL:AppDir%\Windows\System32\
HKLM\SOFTWARE\Classes\.woff\OpenWithProgids\HighLogic.FontCreator.Font=REG_SZ:
HKLM\SOFTWARE\Classes\.woff2\OpenWithProgids\HighLogic.FontCreator.Font=REG_SZ:

[RegistryCleanupForce]
1=HKLM\SOFTWARE\Classes\AppID\{00FC221C-108B-4A53-884F-3AC1B036FA65}
2=HKLM\SOFTWARE\Classes\CLSID\{00FC221C-108B-4A53-884F-3AC1B036FA65}
3=HKLM\SOFTWARE\Classes\.fcp
4=HKLM\SOFTWARE\High-Logic\FontCreator
5=HKLM\SOFTWARE\Classes\AppID\FontInstaller2.dll
6=HKLM\SOFTWARE\Classes\FontInstaller2.MyFontInstallerObject
7=HKLM\SOFTWARE\Classes\HighLogic.FontCreator.Font
8=HKLM\SOFTWARE\Classes\HighLogic.FontCreator.Project
9=HKCU\Software\High-Logic\FontCreator
10=HKLM\SOFTWARE\Classes\Interface\{00FB9B33-BA33-498E-AE8A-6AAE0BF22865}
11=HKLM\SOFTWARE\Classes\.otf\OpenWithProgids
12=HKLM\SOFTWARE\Classes\.ttc\OpenWithProgids
13=HKLM\SOFTWARE\Classes\.ttf\OpenWithProgids
14=HKLM\SOFTWARE\Classes\TypeLib\{00FA5C55-FD1B-404C-BF09-2191508D2A65}
15=HKLM\SOFTWARE\Classes\.woff
16=HKLM\SOFTWARE\Classes\.woff2

[RegistryCleanupIfEmpty]
1=HKLM\SOFTWARE\High-Logic
2=HKCU\Software\High-Logic

[FilesMove]
Windows\SysWOW64\FontInstaller2.dll=%SystemRoot%\SysWOW64\

[DirectoriesMove]
FontCreator13=%APPDATA%\FontCreator13

[FileWrite1]
Type=Replace
File=%PAL:DataDir%\settings\FontCreator.reg 
Find=%PAL:LastDrive%%PAL:LastPackagePartialDir:DoubleBackslash%\\
Replace=%PAL:Drive%%PAL:PackagePartialDir:DoubleBackslash%\\

[FileWrite2]
Type=Replace
File=%PAL:DataDir%\settings\FontCreator.reg 
Find=%PAL:LastPortableAppsBaseDir:DoubleBackslash%\\
Replace=%PAL:PortableAppsBaseDir:DoubleBackslash%\\

[FileWrite3]
Type=Replace
File=%PAL:DataDir%\settings\FontCreator.reg 
Find=%PAL:LastDrive%\\
Replace=%PAL:Drive%\\